# Aim 2


## 24-month brain atrophy

![figures/scatterplotMatrixBrainAtrophy.png](figures/scatterplotMatrixBrainAtrophy.png)

```{r, fig.show = "hide"}
setDens <- function (data, mapping, ...) {
  ggplot(data = data, mapping = mapping) +
    geom_density(..., alpha = 1/2)
}
setPoints <- function (data, mapping, ...) {
  ggplot(data = data, mapping = mapping) +
    geom_point(..., alpha = 1/2)
}
G <- 
  ggpairs(df2,
          columns = c(3, 5, 6),
          mapping = ggplot2::aes(color = studyArm, fill = studyArm),
          diag = list(continuous = setDens),
          lower = list(continuous = setPoints)) +
  theme_bw()
G
ggsave("figures/scatterplotMatrixBrainAtrophy.svg", width = 6, height = 6)
ggsave("figures/scatterplotMatrixBrainAtrophy.png", width = 6, height = 6)
```

Linear model.

```{r brainAtrophy}
df2 <- 
  df2 %>% 
  mutate(invConcRatioM0 = 1 / concRatioM0)
M <- lm(brainAtrophy ~ studyArm, data = df2)
summary(M)
M <- update(M, . ~ studyArm + pctChangeConcRatio)
summary(M)
M <- update(M, . ~ studyArm + pctChangeConcRatio + concRatioM0)
summary(M)
M <- update(M, . ~ studyArm + pctChangeConcRatio + invConcRatioM0)
summary(M)
M <- update(M, . ~ studyArm + concRatioM0)
summary(M)
M <- update(M, . ~ studyArm + invConcRatioM0)
summary(M)
```

```{r brainAtrophyDiagnostics}
tidy(M) %>% kable(digits = 2)
res <- residuals(M)
plot(res)
qqnorm(res)
plot(M)
rm(M, res)
```
